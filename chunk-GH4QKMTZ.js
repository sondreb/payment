import{$a as H,Ab as $,Cb as z,Db as F,Eb as U,Fa as m,Ha as P,Ka as l,Ma as M,Na as S,Oa as i,Pa as o,Qa as k,Ra as f,Sa as x,Ta as c,Ua as O,Y as d,Ya as a,Za as g,_a as w,ba as u,ca as C,fb as p,gb as v,hb as E,ma as b,oa as r,ta as h,ub as T,vb as V,wb as I}from"./chunk-WLESOZGV.js";var R=(e,n)=>n.id;function q(e,n){if(e&1&&(i(0,"div",8),a(1," Transaction: "),i(2,"a",12),a(3),o()()),e&2){let t=c().$implicit;r(2),O("href","https://stellar.expert/explorer/public/tx/",t.transactionId,"",b),r(),g(t.transactionId)}}function B(e,n){e&1&&(i(0,"div",10)(1,"span",13),a(2,"\u2713"),o()())}function L(e,n){if(e&1){let t=f();k(0,"qrcode",14),i(1,"div",10)(2,"button",15),x("click",function(){u(t);let s=c().$implicit,y=c(2);return C(y.checkPaymentStatus(s))}),a(3," Check Status "),o()()}if(e&2){let t=c().$implicit;P("qrdata",t.paymentUrl)("width",128)("errorCorrectionLevel","M")}}function N(e,n){if(e&1){let t=f();i(0,"div",3)(1,"div",4)(2,"div",5),a(3),o(),i(4,"div",6),a(5),p(6,"date"),o(),i(7,"div",7),a(8),o(),m(9,q,4,3,"div",8),o(),i(10,"div",9),m(11,B,3,0,"div",10)(12,L,4,3),i(13,"button",11),x("click",function(){let s=u(t).$implicit,y=c(2);return C(y.copyPaymentUrl(s.paymentUrl))}),a(14,"Copy Payment URL"),o()()()}if(e&2){let t=n.$implicit;r(3),H("",t.amount," ",t.assetCode,""),r(2),g(E(6,6,t.timestamp,"medium")),r(3),w("To: ",t.destination,""),r(),l(t.transactionId?9:-1),r(2),l(t.isPaid?11:12)}}function j(e,n){if(e&1&&(i(0,"div",1),M(1,N,15,9,"div",3,R),p(3,"async"),o()),e&2){let t=c();r(),S(v(3,0,t.history$))}}function A(e,n){e&1&&(i(0,"div",2),a(1," No payment history available "),o())}var D=class e{historyService=d(F);paymentValidator=d(U);clipboard=d($);history$=this.historyService.getHistory();copyPaymentUrl(n){this.clipboard.copy(n)}checkPaymentStatus(n){this.paymentValidator.startValidation({memo:n.memo,expectedAmount:n.amount,assetCode:n.assetCode,destination:n.destination}),this.paymentValidator.validationStatus$.subscribe(t=>{t?.isPaid&&this.historyService.updatePaymentStatus(n.memo,!0,t.transactionId)})}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=h({type:e,selectors:[["app-history"]],decls:6,vars:3,consts:[[1,"history-container"],[1,"history-list"],[1,"empty-state"],[1,"payment-card"],[1,"payment-info"],[1,"amount"],[1,"timestamp"],[1,"destination"],[1,"transaction-id"],[1,"payment-actions"],[1,"payment-status"],[3,"click"],["target","_blank",3,"href"],[1,"status-icon","success","large"],[3,"qrdata","width","errorCorrectionLevel"],[1,"check-status-btn",3,"click"]],template:function(t,_){if(t&1&&(i(0,"div",0)(1,"h1"),a(2,"Payment History"),o(),m(3,j,4,2,"div",1),p(4,"async"),m(5,A,2,0,"div",2),o()),t&2){let s;r(3),l((s=v(4,1,_.history$))!=null&&s.length?3:5)}},dependencies:[I,T,V,z],styles:[".history-container[_ngcontent-%COMP%]{padding:2rem;max-width:800px;margin:0 auto}.payment-card[_ngcontent-%COMP%]{background:#fff;border-radius:8px;padding:1rem;margin-bottom:1rem;box-shadow:0 2px 4px #0000001a;display:flex;justify-content:space-between;align-items:center}.payment-info[_ngcontent-%COMP%]{flex:1}.amount[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:500;color:#2b4e61}.timestamp[_ngcontent-%COMP%]{color:#666;font-size:.875rem;margin:.5rem 0}.destination[_ngcontent-%COMP%]{font-family:monospace;word-break:break-all}.payment-actions[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:1rem}button[_ngcontent-%COMP%]{padding:.5rem 1rem;border:none;border-radius:4px;background:#007bff;color:#fff;cursor:pointer}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:2rem;color:#666}.payment-status[_ngcontent-%COMP%]{display:flex;align-items:center;margin-top:.5rem}.status-icon.success[_ngcontent-%COMP%]{color:#2ecc71;font-size:1.5rem}.check-status-btn[_ngcontent-%COMP%]{padding:.5rem 1rem;background-color:#3498db;color:#fff;border:none;border-radius:4px;cursor:pointer;font-size:.9rem;transition:background-color .3s}.check-status-btn[_ngcontent-%COMP%]:hover{background-color:#2980b9}.transaction-id[_ngcontent-%COMP%]{font-size:.875rem;margin-top:.5rem}.transaction-id[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#3498db;text-decoration:none}.transaction-id[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:underline}.status-icon.success.large[_ngcontent-%COMP%]{font-size:4rem;margin:1rem 0}"]})};export{D as HistoryComponent};
